<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ANNA'S ISLAND</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/controls/OrbitControls.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.128/examples/js/loaders/GLTFLoader.js"></script>
    <style>
        body {
            margin: 0;
            overflow: hidden;
            background-color: black; /* Keep background black */
        }

        #intro {
            display: flex;
            align-items: center;
            justify-content: center;
            flex-direction: column;
            background-color: black;
            color: white;
            font-family: 'Didot', serif;
            font-size: calc(16px + 0.8vw);
            text-align: center;
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            z-index: 1000;
        }

        .word {
            opacity: 0;
            transition: opacity 1s ease;
        }

        canvas {
            display: block;
        }

        #title {
            position: absolute;
            top: 5%;
            left: 50%;
            transform: translateX(-50%);
            font-size: calc(20px + 1vw);
            color: orange;
            font-family: 'Didot', serif;
            z-index: 1000;
            text-align: center;
        }

        #footer-text {
            position: absolute;
            bottom: 5%;
            left: 50%;
            transform: translateX(-50%);
            font-size: calc(14px + 0.8vw);
            color: rgba(255, 255, 255, 0.5);
            font-family: 'Didot', serif;
            z-index: 1000;
            text-align: center;
        }
    </style>
</head>
<body>
    <div id="intro">
        <div class="word">Remember</div>
        <div class="word">how</div>
        <div class="word">you</div>
        <div class="word">once</div>
        <div class="word">told</div>
        <div class="word">me</div>
        <div class="word">how</div>
        <div class="word">much</div>
        <div class="word">you</div>
        <div class="word">like</div>
        <div class="word">the</div>
        <div class="word">idea</div>
        <div class="word">behind</div>
        <div class="word">Rose</div>
        <div class="word">Island?</div>
        <div class="word" style="margin-top: 20px;">Well,</div>
        <div class="word">here</div>
        <div class="word">is</div>
        <div class="word">one</div>
        <div class="word">for</div>
        <div class="word">you.</div>
    </div>
    <div id="title" style="display: none;">ANNA'S ISLAND</div>
    <div id="footer-text" style="display: none;">buon compleanno, maus</div>

    <script>
        const intro = document.getElementById('intro');
        const title = document.getElementById('title');
        const footerText = document.getElementById('footer-text');
        const words = document.querySelectorAll('.word');

        let loaded = false;

        // Animate intro words with pauses
        function animateWords() {
            let delay = 0;
            words.forEach((word, index) => {
                setTimeout(() => {
                    word.style.opacity = 1;

                    // Add pauses for specific words
                    if (index === 14) delay += 1000; // Pause after "Island?"
                    if (index === 15) delay += 1000; // Pause after "Well,"
                }, delay);
                delay += 500; // Standard delay for each word
            });
        }

        // Fade out intro text
        function fadeOutIntro() {
            intro.style.transition = 'opacity 1.5s ease';
            intro.style.opacity = 0;

            setTimeout(() => {
                intro.style.display = 'none'; // Hide intro completely after fade out
                if (loaded) {
                    startIslandScene();
                }
            }, 1500);
        }

        // Preload model and assets
        function preloadAssets(callback) {
            const loader = new THREE.GLTFLoader();
            loader.load(
                './result.gltf',
                (gltf) => {
                    loaded = true;
                    callback(gltf);
                },
                undefined,
                (error) => {
                    console.error('An error occurred while preloading assets:', error);
                }
            );
        }

        // Initialize 3D scene
        function startIslandScene() {
            // Scene setup
            const scene = new THREE.Scene();

            // Camera and renderer setup
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000);
            camera.position.set(0, 10, 20);

            const renderer = new THREE.WebGLRenderer({ antialias: true });
            renderer.setSize(window.innerWidth, window.innerHeight);
            document.body.appendChild(renderer.domElement);

            // OrbitControls setup
            const controls = new THREE.OrbitControls(camera, renderer.domElement);

            controls.minPolarAngle = (5 * Math.PI) / 180; // Minimum angle: 5 degrees (in radians)
            controls.maxPolarAngle = (3 * Math.PI) / 7; // Maximum angle: 90 degrees (above the plane)

            controls.minDistance = 5; // Minimum zoom distance
            controls.maxDistance = 25; // Maximum zoom distance
            controls.enableDamping = true; // Enable damping for smooth controls

            // Lighting setup
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.5); // Reduced intensity
            scene.add(ambientLight);

            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.4); // Reduced intensity
            directionalLight.position.set(5, 10, 5);
            scene.add(directionalLight);

            // Load the GLTF model
            preloadAssets((gltf) => {
                const model = gltf.scene;
                model.position.set(0, 0, 0); // Adjust position if needed
                model.scale.set(0.5, 0.5, 0.5); // Scale down by 2
                scene.add(model);

                // Start rendering
                function animate() {
                    requestAnimationFrame(animate);
                    controls.update();
                    renderer.render(scene, camera);
                }
                animate();
            });

            // Resize handler
            window.addEventListener('resize', () => {
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                renderer.setSize(window.innerWidth, window.innerHeight);
            });
        }

        // Run intro animation
        animateWords();

        // Add click event to fade out and start scene
        intro.addEventListener('click', () => {
            fadeOutIntro();
        });
    </script>
</body>
</html>
